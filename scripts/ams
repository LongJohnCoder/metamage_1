#!/bin/sh

AppName="$1"

if [ -z "$AppName" ]; then
	AppName=TestApp
fi

mkdir -p ~/var/run/raster

SCREEN=~/var/run/raster/ams
RASTER="--raster=$SCREEN"
FIFO="$SCREEN.fifo"

test -e $FIFO  ||  mkfifo $FIFO
chmod 0622 $FIFO

CORE=ams-core
RSRC=ams-rsrc

interact $RASTER -t "Advanced Mac Substitute" | \
graft 8<&0 \
	freemountd -q --root ~/68k // \
	xv68k $RASTER -m [ $CORE --events-fd=8 -Q ] -m $RSRC ~/68k/app $AppName
